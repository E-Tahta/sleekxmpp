Description: fix for CVE-2017-5591
 An incorrect implementation of XEP-0280: Message Carbons in slixmpp allows a
 remote attacker to impersonate any user, including contacts, in the vulnerable
 application's display. This allows for various kinds of social engineering
 attacks.
Author: mathieui <github@mathieui.net>
Origin: other, https://github.com/poezio/slixmpp/commit/22664ee7b86c8e010f312b66d12590fb471
Bug: https://github.com/fritzy/SleekXMPP/issues/442
Bug-Debian: https://bugs.debian.org/854739
Last-Update: 2017-03-23
---
This patch header follows DEP-3: http://dep.debian.net/deps/dep3/
--- a/sleekxmpp/plugins/xep_0280/carbons.py
+++ b/sleekxmpp/plugins/xep_0280/carbons.py
@@ -61,10 +61,12 @@
         self.xmpp.plugin['xep_0030'].add_feature('urn:xmpp:carbons:2')
 
     def _handle_carbon_received(self, msg):
-        self.xmpp.event('carbon_received', msg)
+        if msg['from'].bare == self.xmpp.boundjid.bare:
+            self.xmpp.event('carbon_received', msg)
 
     def _handle_carbon_sent(self, msg):
-        self.xmpp.event('carbon_sent', msg)
+        if msg['from'].bare == self.xmpp.boundjid.bare:
+            self.xmpp.event('carbon_sent', msg)
 
     def enable(self, ifrom=None, block=True, timeout=None, callback=None):
         iq = self.xmpp.Iq()
